{% extends "layout.html" %}
{% block content %}
<div class="toolbar">
  <div>
    <p class="hint">Exam: {{ exam.title }}</p>
    <h2>Answer key</h2>
  </div>
  <div class="actions">
    <a class="btn" href="{{ url_for('instructor.add_question', exam_id=exam.id) }}">Add question</a>
    <a class="btn ghost" href="{{ url_for('instructor.instructor_dashboard') }}">Back</a>
  </div>
</div>

<form method="post" class="card">
  {% for question in exam.questions %}
    <div class="review-item">
      <p class="question-text">{{ loop.index }}. {{ question.text|normalize_imgs|safe }} <span class="hint">({{ question.qtype }})</span></p>
      <div class="choices">
        {% for choice in question.choices %}
          <label class="choice">
            <input
              type="{{ 'checkbox' if question.qtype == 'multiple' else 'radio' }}"
              name="q_{{ question.id }}"
              value="{{ choice.id }}"
              {% if choice.is_correct %}checked{% endif %}
            >
            <div class="choice-body">
              <span class="choice-text">{{ choice.text }}</span>
              {% set cimg = choice.image_path|img_url %}
              {% if cimg %}
                <img src="{{ cimg }}" alt="Option image" class="choice-image">
              {% endif %}
            </div>
          </label>
        {% endfor %}
      </div>
    </div>
  {% endfor %}
  <div class="actions">
    <button type="submit">Save answer key</button>
  </div>
</form>
{% endblock %}
